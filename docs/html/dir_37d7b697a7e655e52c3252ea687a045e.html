<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GENG Engine: include/engine/types/strings Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">GENG Engine
   </div>
   <div id="projectbrief">A lightweight, web-targeted, object-oriented game engine built with Emscripten + SDL2</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('dir_37d7b697a7e655e52c3252ea687a045e.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">strings Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-subdirs" class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:fstring" id="r_fstring"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_d298bff13bbfed2b962b86b3d9b48a94.html">fstring</a></td></tr>
<tr class="memitem:hstring" id="r_hstring"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_0a3bed381ca844af45bc215e4de8bbd9.html">hstring</a></td></tr>
<tr class="memitem:str_5Fview" id="r_str_5Fview"><td class="memItemLeft" align="right" valign="top"><span class="iconfolder"><div class="folder-icon"></div></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_5001f10696f7c046eb8dce289c78f884.html">str_view</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<h1 class="doxsection"><a class="anchor" id="autotoc_md0"></a>
Strings Overview</h1>
<p>Ok with all these strings it might get a little confusing, so I'll break each one down below.</p>
<p>Each of my custom string classes have some really nice properties that makes it super easy to pass around data. For example, lets say I have an <span class="tt">hstring</span> and I want to store all the data from my <span class="tt">Sprite s</span>. What I can do is this: </p><div class="fragment"><div class="line">hstring my_string(50); <span class="comment">// Allocates 50 characters to the heap</span></div>
<div class="line">my_string &lt;&lt; sprite.pos.x &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; sprite.pos.y &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">my_string &lt;&lt; sprite.animnum &lt;&lt; <span class="stringliteral">&quot;,\t&quot;</span> &lt;&lt; sprite.framenum; </div>
</div><!-- fragment --><p> Thus all the data is immediately converted into the hstring formatted like <span class="tt">"30.0 40.0\n3,\t4"</span>. Furthermore, I can add even nicer features like: </p><div class="fragment"><div class="line">mystring &lt;&lt; trunc&lt;4&gt;() &lt;&lt; my_float &lt;&lt; geng::endl;</div>
</div><!-- fragment --><p> Now, my_float will be truncated to four digits automatically without me having to do any annoying calculations. Now to get on to each type of string. </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
fstrings</h2>
<p>First up we have <span class="tt">fstring</span>, which stands for <b>fixed string</b>. <span class="tt">fstring</span> is a templatede class, and this means that upon creation, these strings have completely <b>fixed length</b> that cannot be changed. These are great for text buffers that get refreshed repeatedly, and for ensuring compliance with specific string lengths. However, the main benefits are below:</p><ul>
<li>Significantly faster for writing and conversion than regular <span class="tt">std::string</span> (around 2x - 3x faster)</li>
<li>Lives on the stack, so heap fragmentation (especially in WASM) is not a concern for fstrings</li>
<li>Prevents any overflow automatically.</li>
</ul>
<p>For example, the <span class="tt"><a class="el" href="classgeng_1_1_text.html">geng::Text</a></span> class is templated with an <span class="tt">fstring</span>, because in reality, displayed text on screen should never be unbounded, and when users make a text object, they should define how it will be used.</p>
<p>Note that <span class="tt">fstrings</span> have an internal limit of 65442 characters as a built in cap. Creating more than that many characters is bad for the stack and should not happen.</p><ul>
<li>Downsides: You must know your string length at compile time, so don't use this for managing something like a pathname. (However, it is good for preventing users from adding too much input.)</li>
<li>You can't pass fstrings through virtual functions cause' they're templated. However, there's a real good solution for this in the <span class="tt">str_view</span> section.</li>
</ul>
<p>Here's an example of how to make an fstring: </p><div class="fragment"><div class="line">geng::fstring&lt;10&gt; fstr; <span class="comment">// creates fstring with 10 char limit;</span></div>
<div class="line">fstr &lt;&lt; <span class="stringliteral">&quot;Hello World!\n&quot;</span>; <span class="comment">// pipes in &quot;hello world!\n&quot; (14 chars)</span></div>
<div class="line">std::cerr &lt;&lt; fstr.cstr() &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> Our output from this will be <span class="tt">Hello worl</span>, because we only allocated 10 characters.</p>
<p><b>Warning:</b> <span class="tt">fstring</span> always allocates two additional bytes past what you specify to the internal character array. One is for the null terminator (at size + 0), and the next is for floating point conversion information (at size + 1).</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
hstrings</h2>
<p>Ok we'll keep this short. <span class="tt">hstrings</span> are just <span class="tt">fstrings</span> but their memory is allocated on the heap, and they don't have a fixed size.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
Pros:</h3>
<ul>
<li>Still faster than regular <span class="tt">std::string</span>, but not by as much as <span class="tt">fstring</span></li>
<li>Dynamically resizable &amp; virtually unlimited size</li>
<li>Access to all the nice operator overloads <span class="tt">fstring</span> has. </li>
</ul>
<h3 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Cons:</h3>
<ul>
<li>It's on the heap, so fragmentation can be a problem</li>
<li>Slower than <span class="tt">fstring</span></li>
<li>Higher memory baseline than <span class="tt">fstring</span></li>
<li>Constantly allocates new memory, which is really bad for WASM environment</li>
<li>Cannot limit it's own size. It's buffer will grow to the C++ 32-bit unsigned int limit.</li>
<li>Not memory-safe</li>
</ul>
<p>Thus, for most general cases, please please please use an <span class="tt">fstring</span> as they're so much better for engine performance than hstrings. Though there are several cases where <span class="tt">hstrings</span> are the best answer:</p><ol type="1">
<li>Path names</li>
<li>System-wide data collection</li>
<li>That's pretty much it.</li>
</ol>
<p>Moral of the story: use fstring. Mostly anything in a game engine is predictable enough that you can predict close to the number of characters you'll need before compilation. </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
str_view</h2>
<p>Now this is the crown-jewel of the string implementation. You might think "it's hella uncool to try and manage two different string types when writing code", and you'd be right. Hence, we have the <span class="tt">str_view</span> (name generously borrowed from the standard library).</p>
<p>Instead of passing <span class="tt">fstring</span> and <span class="tt">hstring</span> through functions, you pass <span class="tt">str_view</span> instead, and you do this by "wrapping" the strings. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> add_to_buffer(str_view buffer, <span class="keywordtype">float</span> my_float) {</div>
<div class="line">    <span class="comment">// adds a float to the string with a precision of 4</span></div>
<div class="line">    buffer &lt;&lt; trunc&lt;4&gt;() &lt;&lt; my_float; </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>() {</div>
<div class="line">    <span class="comment">// create our strings</span></div>
<div class="line">    fstring&lt;300&gt; fixed_string = <span class="stringliteral">&quot;My fixed string: &quot;</span>;</div>
<div class="line">    hstring heap_string = <span class="stringliteral">&quot;My dynamically allocated string: &quot;</span>;</div>
<div class="line">    <span class="comment">// now we add to buffer</span></div>
<div class="line">    add_to_buffer(fixed_string.wrap(), 30.1234567f);</div>
<div class="line">    add_to_buffer(heap_string.wrap(), 90.1234567f);</div>
<div class="line">    <span class="comment">// print to console</span></div>
<div class="line">    std::cerr &lt;&lt; fixed_string.cstr() &lt;&lt; std::endl;</div>
<div class="line">    std::cerr &lt;&lt; heap_string.cstr() &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="amain_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> main.cpp:42</div></div>
</div><!-- fragment --> <div class="fragment"><div class="line">output:</div>
<div class="line">My fixed string: 30.1234</div>
<div class="line">My heap string: 90.1234</div>
</div><!-- fragment --><p> Now you may be wondering, "how does this work"? And i'll say its magic cause i dont wanna bore you with the implementation. (it's just references &amp; pointers, and a shit ton of operator overloads). </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Usage</h2>
<p><span class="tt">hstring</span> and <span class="tt">fstring</span> have the same member functions, so i'll cover them together.</p><ul>
<li><span class="tt">capacity()</span>› Returns current capacity of the string</li>
<li><span class="tt">length()</span> › Returns length of the string</li>
<li><span class="tt">cstr()</span>› Returns a C-style string (usefull for printing to std::cout)</li>
<li><span class="tt">clear()</span> › Clears out the string. Does not resize</li>
<li><span class="tt">operator[](index i)</span> › Accesses at index <span class="tt">i</span></li>
</ul>
<p>That's pretty much it. You also have a ton of operator overloads as well:</p><ul>
<li><span class="tt">==</span> › Works from (<span class="tt">str_view</span> compatable):<ul>
<li><span class="tt">fstring ‹-› fstring</span></li>
<li><span class="tt">hstring ‹-› hstring</span></li>
<li><span class="tt">fstring ‹-› const char[]</span></li>
<li><span class="tt">hstring ‹-› const char[]</span></li>
</ul>
</li>
<li><span class="tt">&lt;&lt;</span> › Works with (<span class="tt">str_view</span> compatable):<ul>
<li><span class="tt">f/hstring ‹-› bool, int, float, double, void*, f/hstring</span></li>
</ul>
</li>
<li><span class="tt">+</span> › Works with<ul>
<li><span class="tt">fstring ‹-› fstring</span> › Creates new fstring of combined capacity, so be careful.</li>
</ul>
</li>
</ul>
<p><span class="tt">str_view</span> also has one specialty function: <span class="tt">subview(uint32_t start, uint32_t sub_len)</span>. This creates a const <span class="tt">str_subview</span> object that has access to a singular operator overload: <span class="tt">== const char[]</span>.</p>
<p>You might ask, what the fuck? Why would you make that? Simple reason: syntax highlighting. Let's say you have a text parser who takes in a str_view object. <span class="tt">.subview</span> acts as an equivalent to <span class="tt">.substr</span>, except there's no dynamic memory allocation, and extremely quick comparison to string literals.</p>
<p>Subview (and the rest of this string suite) is optimized to use any information, like the length of a constant literal, to it's advantage. Thus, comparisons between <span class="tt">str_subview</span> objects and const char objects are rapid. Most of the time you don't even need to store the created <span class="tt">str_subview</span> object. For example: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; my_str_view.length(); i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (my_str_view.subview(i, 4) == <span class="stringliteral">&quot;true&quot;</span>) {</div>
<div class="line">        color_text(<span class="stringliteral">&quot;blue&quot;</span>);</div>
<div class="line">        i+=3;</div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Isn't that nifty. That's all i have to say for now bye. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a href="dir_a7f531b1c37460085cedd304cb8df01d.html">engine</a></li><li class="navelem"><a href="dir_dc82f37e84fb9e33ffed535c9bae5fe3.html">types</a></li><li class="navelem"><a href="dir_37d7b697a7e655e52c3252ea687a045e.html">strings</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
